`1350600484s_list` <- read.delim("~/arXiv papers/Systems Biology Class/arXiv/1350600484s_list.xls", header=F)
View(`1350600484s_list`)
`1350600484s_list` <- read.delim("~/arXiv papers/Systems Biology Class/arXiv/1350600484s_list.xls")
View(`1350600484s_list`)
source("http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/My_R_Scripts/overLapper.R")
siRNA.primary.hits.lists <- read.delim("~/R/working directory/siRNA primary hits lists.txt")
View(siRNA.primary.hits.lists)
sets <- read.delim(siRNA primary hits lists.txt"); setlistImp <- lapply(colnames(sets), function(x) as.character(sets[sets[,x]!="", x])); names(setlistImp) <- colnames(sets)
sets <- read.delim("siRNA primary hits lists.txt"); setlistImp <- lapply(colnames(sets), function(x) as.character(sets[sets[,x]!="", x])); names(setlistImp) <- colnames(sets)
sets <- read.delim("~/R/working directory/siRNA primary hits lists.txt"); setlistImp <- lapply(colnames(sets), function(x) as.character(sets[sets[,x]!="", x])); names(setlistImp) <- colnames(sets)
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlis)
setlist <- list(A=sample(letters, 18), B=sample(letters, 16), C=sample(letters, 20), D=sample(letters, 22), E=sample(letters, 18), F=sample(letters, 22, replace=T))
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlis)
source("http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/My_R_Scripts/overLapper.R")
setlist <- list(A=BRASS, B=SHAPIRA, C=KARLAS, D=KINOG, E=HAO)
setlist <- list(BRASS=sample(numbers, 250), SHAPIRA=sample(numbers, 220), KARLAS=sample(numbers, 287), KONIG=sample(numbers, 295), HAO=sample(numbers, 130))
citation()
citation(gplots)
citation(gplot)
citation(graphics)
citation("graphics")
endog98lists <- read.delim("~/arXiv papers/candidacy stuff/new version 2/endog98lists.txt")
View(endog98lists)
endog98lists <- read.delim("~/arXiv papers/candidacy stuff/new version 2/endog98lists.txt")
View(endog98lists)
setlist <- list(N98PPI=as.character(endog98lists [,1]),
N98KD1up=as.character(endog98lists [,2]),
N98KD1down=as.character(endog98lists [,3]),
N98KD2up=as.character(endog98lists [,4]),
N98KD2down=as.character(endog98lists [,5]),
N98NtOEup=as.character(endog98lists [,6]),
N98NtOEdown=as.character(endog98lists [,7]),
N98ChIP=as.character(endog98lists [,8]),
N98Fdam=as.character(endog98lists [,9]),
N98NTdam=as.character(endog98lists [,10]),
setlist <- list(N98PPI=as.character(endog98lists [,1]),                 N98KD1up=as.character(endog98lists [,2]),
+                 N98KD1down=as.character(endog98lists [,3]),
+                 N98KD2up=as.character(endog98lists [,4]),
+                 N98KD2down=as.character(endog98lists [,5]),
+                 N98NtOEup=as.character(endog98lists [,6]),
+                 N98NtOEdown=as.character(endog98lists [,7]),
+                 N98ChIP=as.character(endog98lists [,8]),
+                 N98Fdam=as.character(endog98lists [,9]),
+                 N98NTdam=as.character(endog98lists [,10]),
+                 N98NPCdam=as.character(endog98lists [,11]),
+                 N98Fdam2=as.character(endog98lists [,12]),
+                 N98NTdam2=as.character(endog98lists [,13]),
+                 All_lists=as.character(endog98lists [,14]))
setlist <- list(N98PPI=as.character(endog98lists [,1]),
N98KD1up=as.character(endog98lists [,2]),
N98KD1down=as.character(endog98lists [,3]),
N98KD2up=as.character(endog98lists [,4]),
N98KD2down=as.character(endog98lists [,5]),
N98NtOEup=as.character(endog98lists [,6]),
N98NtOEdown=as.character(endog98lists [,7]),
N98ChIP=as.character(endog98lists [,8]),
N98Fdam=as.character(endog98lists [,9]),
N98NTdam=as.character(endog98lists [,10]),
N98NPCdam=as.character(endog98lists [,11]),
N98Fdam2=as.character(endog98lists [,12]),
N98NTdam2=as.character(endog98lists [,13]),
All_lists=as.character(endog98lists [,14]))
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlist)
source("http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/My_R_Scripts/overLapper.R")
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlist)
endog98lists <- read.delim("~/arXiv papers/candidacy stuff/new version 2/endog98lists.txt")
View(endog98lists)
setlist <- list(N98PPI=as.character(endog98lists [,1]),
N98KD1up=as.character(endog98lists [,2]),
N98KD1down=as.character(endog98lists [,3]),
N98KD2up=as.character(endog98lists [,4]),
N98KD2down=as.character(endog98lists [,5]),
N98NtOEup=as.character(endog98lists [,6]),
N98NtOEdown=as.character(endog98lists [,7]),
N98ChIP=as.character(endog98lists [,8]),
N98Fdam=as.character(endog98lists [,9]),
N98NTdam=as.character(endog98lists [,10]),
N98NPCdam=as.character(endog98lists [,11]),
N98Fdam2=as.character(endog98lists [,12]),
N98NTdam2=as.character(endog98lists [,13]),
All_lists=as.character(endog98lists [,14]))
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlist)
olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6, main="Venn Bar Plot")
olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6,mincount=1, main="Venn Bar Plot")
OLexport <- as.matrix(unlist(sapply(OLlist5[[4]], paste, collapse=" ")))
write.table(OLexport, file="matrixexp.xls", col.names=F, quote=F, sep="\t")
OLexport <- as.matrix(unlist(sapply(OLlist5[[4]], paste, collapse=" ")))
OLexport <- as.matrix(unlist(sapply(OLlist[[4]], paste, collapse=" ")))
write.table(OLexport, file="matrixexp.xls", col.names=F, quote=F, sep="\t")
OLexport <- data.frame(Venn_Comp=rep(names(OLlist[[4]]), sapply(OLlist[[4]], length)), IDs=unlist(OLlist5[[4]]))
write.table(OLexport, file="tabularexp.xls", row.names=F, quote=F, sep="\t")
OLexport <- data.frame(Venn_Comp=rep(names(OLlist[[4]]), sapply(OLlist[[4]], length)), IDs=unlist(OLlist[[4]]))
write.table(OLexport, file="tabularexp.xls", row.names=F, quote=F, sep="\t")
counts <- sapply(OLlist[[4]], length)
counts <- sapply(OLlist[[4]], length)
tapply(counts, OLlist[[3]], function(x) rev(sort(x)))
olMA <- sapply(names(setlist), function(x) sapply(names(setlist), function(y) sum(setlist[[x]] %in% setlist[[y]]))); olMA
library("gplots"); heatmap.2(olMA, trace="none", Colv="none", Rowv="none", dendrogram="none", col=colorpanel(40, "darkred", "orange", "yellow"))
heatmap.2(olMA, trace="none", col=colorpanel(40, "darkred", "orange", "yellow"))
paMA <- overLapper(setlist=setlist, type="intersects", complexity=2)[[2]]
paMA[names(rev(sort(rowSums(paMA)))),]
library("gplots"); heatmap.2(paMA, trace="none", Colv="none", Rowv="none", dendrogram="none", col=c("white", "gray"))
View(paMA)
View(paMA)
write.csv(paMa, "paMa98endog.csv")
write.csv(paMA, "paMa98endog.csv")
View(OLexport)
fix(OLlist)
endog98lists2 <- read.delim("~/arXiv papers/candidacy stuff/new version 2/endog98lists2.txt")
View(endog98lists2)
source("http://faculty.ucr.edu/~tgirke/Documents/R_BioCond/My_R_Scripts/overLapper.R")
setlist <- list(N98PPI=as.character(endog98lists [,1]),
N98KD1up=as.character(endog98lists [,2]),
N98KD1down=as.character(endog98lists [,3]),
N98KD2up=as.character(endog98lists [,4]),
N98KD2down=as.character(endog98lists [,5]),
N98NtOEup=as.character(endog98lists [,6]),
N98NtOEdown=as.character(endog98lists [,7]),
N98ChIP=as.character(endog98lists [,8]),
N98Fdam=as.character(endog98lists [,9]),
N98NTdam=as.character(endog98lists [,10]),
N98NPCdam=as.character(endog98lists [,11]),
N98Fdam2=as.character(endog98lists [,12]),
N98NTdam2=as.character(endog98lists [,13]))
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlist)
olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6,mincount=1, main="Venn Bar Plot")
OLexport <- as.matrix(unlist(sapply(OLlist[[4]], paste, collapse=" ")))
write.table(OLexport, file="matrixexp2.xls", col.names=F, quote=F, sep="\t")
OLexport <- data.frame(Venn_Comp=rep(names(OLlist[[4]]), sapply(OLlist[[4]], length)), IDs=unlist(OLlist[[4]]))
write.table(OLexport, file="tabularexp2.xls", row.names=F, quote=F, sep="\t")
counts <- sapply(OLlist[[4]], length)
tapply(counts, OLlist[[3]], function(x) rev(sort(x)))
olMA <- sapply(names(setlist), function(x) sapply(names(setlist), function(y) sum(setlist[[x]] %in% setlist[[y]]))); olMA
library("gplots"); heatmap.2(olMA, trace="none", Colv="none", Rowv="none", dendrogram="none", col=colorpanel(40, "darkred", "orange", "yellow"))
library("gplots"); heatmap.2(olMA, trace="none", Colv="none", Rowv="none", dendrogram="none", col=colorpanel(40, "darkred", "orange", "yellow"))
heatmap.2(olMA, trace="none", col=colorpanel(40, "darkred", "orange", "yellow"))
paMA <- overLapper(setlist=setlist, type="intersects", complexity=2)[[2]]
paMA[names(rev(sort(rowSums(paMA)))),]
write.csv(paMA, "paMa98endog2.csv")
rowSums(paMA)
View(endog98lists2)
endog98lists3 <- read.delim("~/arXiv papers/candidacy stuff/new version 2/endog98lists3.txt")
View(endog98lists3)
setlist <- list(N98PPI=as.character(endog98lists [,1]),
N98KD1up=as.character(endog98lists [,2]),
N98KD1down=as.character(endog98lists [,3]),
N98KD2up=as.character(endog98lists [,4]),
N98KD2down=as.character(endog98lists [,5]),
N98NtOEup=as.character(endog98lists [,6]),
N98NtOEdown=as.character(endog98lists [,7]),
N98ChIP=as.character(endog98lists [,8]),
N98Fdam=as.character(endog98lists [,9]),
N98NTdam=as.character(endog98lists [,10]),
N98NPCdam=as.character(endog98lists [,11]),
N98Fdam2=as.character(endog98lists [,12]),
N98NTdam2=as.character(endog98lists [,13]))
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlist)
setlist <- list(N98PPI=as.character(endog98lists3 [,1]),
N98KD1up=as.character(endog98lists3 [,2]),
N98KD1down=as.character(endog98lists3 [,3]),
N98KD2up=as.character(endog98lists3 [,4]),
N98KD2down=as.character(endog98lists3 [,5]),
N98NtOEup=as.character(endog98lists3 [,6]),
N98NtOEdown=as.character(endog98lists3 [,7]),
N98ChIP=as.character(endog98lists3 [,8]),
N98Fdam=as.character(endog98lists3 [,9]),
N98NTdam=as.character(endog98lists3 [,10]),
N98NPCdam=as.character(endog98lists3 [,11]),
N98Fdam2=as.character(endog98lists3 [,12]),
N98NTdam2=as.character(endog98lists3 [,13]))
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlist)
olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6,mincount=1, main="Venn Bar Plot")
olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6, mincount=1, maxcount=200, main="Venn Bar Plot")
fix(OLlist)
OLlist <- overLapper(setlist=setlist, sep="", type="vennsets"); OLlist; names(OLlist)
counts <- sapply(OLlist[[4]], length)
tapply(counts, OLlist[[3]], function(x) rev(sort(x)))
OLlist
olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6,mincount=1, main="Venn Bar Plot")
x11(height=12, width=8); olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6, main="Intersect Bar Plot")
x11(height=12, width=8); olBarplot(OLlist=OLlist, horiz=T, las=1, cex.names=0.6, mincount=1, main="Intersect Bar Plot")
setlist <- sapply(setlist, unique)
olMA <- sapply(names(setlist), function(x) sapply(names(setlist), function(y) sum(setlist[[x]] %in% setlist[[y]]))); olMA
library("gplots"); heatmap.2(olMA, trace="none", Colv="none", Rowv="none", dendrogram="none", col=colorpanel(40, "darkred", "orange", "yellow"))
heatmap.2(olMA, trace="none", col=colorpanel(40, "darkred", "orange", "yellow"))
paMA <- overLapper(setlist=setlist, type="intersects", complexity=2)[[2]]
paMA[names(rev(sort(rowSums(paMA)))),]
paMA <- overLapper(setlist=setlist, type="intersects", complexity=2)[[2]]
paMA[names(rev(sort(rowSums(paMA))),]
paMA <- overLapper(setlist=setlist, type="intersects", complexity=2)[[2]]
paMA[names(rev(sort(rowSums(paMA)))),]
paMA[names(rev(sort(rowSums(paMA)))),]
paMA <- overLapper(setlist=setlist, type="intersects", complexity=2)[[2]]
paMA[names(rev(sort(rowSums(paMA)))),]
library("gplots"); heatmap.2(paMA, trace="none", Colv="none", Rowv="none", dendrogram="none", col=c("white", "gray"))
paMA
write.csv(paMA, "paMa98endog3.csv")
OLexport <- as.matrix(unlist(sapply(OLlist[[4]], paste, collapse=" ")))
write.table(OLexport, file="matrixexp3.xls", col.names=F, quote=F, sep="\t")
library("AnnotationDbi", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
detach("package:Biobase", unload=TRUE)
library("BiocInstaller", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
library("GEOmetadb", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
detach("package:GEOquery", unload=TRUE)
detach("package:AnnotationDbi", unload=TRUE)
library("AnnotationDbi", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
detach("package:BiocGenerics", unload=TRUE)
library("BiocGenerics", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
detach("package:BiocInstaller", unload=TRUE)
library("BiocInstaller", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
detach("package:GEOmetadb", unload=TRUE)
library("GEOquery", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
library("GEOmetadb", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
library("limma", lib.loc="C:/Users/Juliana/Documents/R/win-library/2.15")
library("rstudio", lib.loc="C:/Program Files/RStudio/R/library")
library("manipulate", lib.loc="C:/Program Files/RStudio/R/library")
biocLite()
library(limma)
design <- model.matrix(~ -1+factor(c(1,1,2,2,3,3)))
rstudio::viewData(design)
colnames(design) <- c("group1", "group2", "group3")
rstudio::viewData(design)
`N98Fdam` <- read.delim("~/arXiv papers/candidacy stuff/new version 2/raw data collected/tables for R/N98Fdam.txt")
viewData(`N98Fdam`)
set.seed(31);
heightsCM = rnorm(30,mean=188, sd=5);
weightsK = rnorm(30,mean=84,sd=3);
hasDaughter = sample(c(TRUE,FALSE),size=30,replace=T);
dataFrame = data.frame(heightsCM,weightsK,hasDaughter);
dataFrameSubset[heights < 188, ]
dataFrameSubset = dataFrame[heights < 188, ]
dataFrameSubset <- dataFrame[heightsCM > 188,  ]
mean(dataFrameSubset$weightsK)
set.seed(41)
cauchyValues <- rvcauchy(n=100, location=0, scale=1)
library(rvcauchy)
library(rv)
help("install.packages")
instal.packages(rv)
intal.packages(rvcauchy)
instal.packages(rvcauchy)
install.packages(rv)
install.packages(rvcauchy)
install.packages(rv-package)
set.seed(41)
cauchyValues <- rcauchy(n=100, location=0, scale=1)
set.seed(415)
sample(cauchyValues,size=10,replace=TRUE)
#Some example values
n_A = 100;n_B = 200; n_C = 500; n_A_B = 50
1-phyper(n_A_B, n_B, n_C-n_B, n_A)
1-phyper
1-phyper()
phyper(?)
qhyper(0.05, 1719, 3800, 357, lower.tail = TRUE, log.p = FALSE)
qhyper(0.001, 1719, 3800, 357, lower.tail = TRUE, log.p = FALSE)
qhyper(0.05, 1719, 3800, 357, lower.tail = FALSE, log.p = FALSE)
qhyper(0.001, 1719, 3800, 357, lower.tail = FALSE, log.p = FALSE)
sim=unlist(lapply(1:10000,
function(i){A=sample(1:27511,23706);B=sample(1:27511,14557);return(sum(A %in% B))}))
hist(sim)
sim=unlist(lapply(1:10000,
function(i){A=sample(1:20000,1719);B=sample(1:20000,3800);return(sum(A %in% B))}))
hist(sim)
?hist
hist(sim, freq=FALSE)
hist(sim)
hist(sim, freq=FALSE)
hist(sim, freq=FALSE, breaks=50)
Table.S1.for.R <- read.delim("C:/Users/Juliana/Desktop/Final stuff for the paper/written paper/Table S1 for R.txt")
View(Table.S1.for.R)
Network <- Table.S1.for.R
Network
dotchart(Network$HITS,labels=Network$GENE.SYMBOL,cex=.7,
main="Identified Nup98 binding proteins",
xlab="Number of unique peptides")
dotchart(Network$HITS,labels=Network$GENE.SYMBOL,cex=1,
+          main="Identified Nup98 binding proteins",
+          xlab="Number of unique peptides")
?dotchart
dotchart(Network$HITS,labels=Network$GENE.SYMBOL,cex=.5,
+          main="Identified Nup98 binding proteins",
+          xlab="Number of unique peptides")
dotchart(Network$HITS,labels=Network$GENE.SYMBOL,cex=.5,main="Identified Nup98 binding proteins",xlab="Number of unique peptides")
dotchart(Network$HITS,labels=Network$GENE.SYMBOL,cex=.3,main="Identified Nup98 binding proteins",xlab="Number of unique peptides")
setwd("~/arXiv papers/candidacy stuff/new version 2/Nup98 fusions/Separate microarray analysis/GSE40531 - HOXD13")
source("http://bioconductor.org/biocLite.R")
cels <- list.files("data/", pattern = "[gz]")
sapply(paste("data", cels, sep="/"), gunzip)
cels
cels <- list.files("data/", pattern = "[gz]")
cels
library(GEOquery)
getGEOSuppFiles("GSE40531")
untar("GSE40531/GSE40531_RAW.tar", exdir="data")
cels <- list.files("data/", pattern = "[gz]")
sapply(paste("data", cels, sep="/"), gunzip)
cels
library(simpleaffy)
celfiles <- read.affy(covdesc="phenodata.txt", path="data")
celfiles
celfiles.gcrma <- gcrma(celfiles)
celfiles.gcrma
library(RColorBrewer)
cols <- brewer.pal(12, "Set3")
library(affyPLM)
par(mfrow=c(1,2))
boxplot(celfiles, col=cols)
boxplot(celfiles.gcrma, col=cols)
par(mfrow=c(1,2))
hist(celfiles, col=cols)
hist(celfiles.gcrma, col=cols)
celfiles.qc <- fitPLM(celfiles)
image(celfiles.qc, which=4, add.legend=TRUE)
par(mfrow=c(1,2))
RLE(celfiles.qc, main="RLE", col=cols)
NUSE(celfiles.qc, main="NUSE", col=cols)
eset <- exprs(celfiles.gcrma)
distance <- dist(t(eset),method="maximum")
clusters <- hclust(distance)
par(mfrow=c(1,1))
plot(clusters)
celfiles.filtered <- nsFilter(celfiles.gcrma, require.entrez=FALSE, remove.dupEntrez=FALSE)
celfiles.filtered$filter.log
samples <- celfiles.gcrma$Target
samples
samples <- as.factor(samples)
samples
design <- model.matrix(~0 + samples)
colnames(design) <- c("LnegBM", "NHD13LnegBM", "NHD13tumor", "NHD13WBM", "Spleen WBM")
design
colnames(design) <- c("LnegBM", "NHD13LnegBM", "NHD13tumor", "NHD13WBM", "Spleen", "WBM")
design
library(limma)
fit <- lmFit(exprs(celfiles.filtered$eset), design)
contrast.matrix <- makeContrasts(NHD13LnegBMvsLnegBM  = NHD13LnegBM - LnegBM, NHD13tumorvsLnegBM  = NHD13tumor - LnegBM, NHD13tumorvsNHD13LnegBM = NHD13tumor - NHD13LnegBM, NHD13tumorvsNHD13WBM = NHD13tumor - NHD13WBM, NHD13tumorvsSpleen = NHD13tumor - Spleen, NHD13tumorvsWBM = NHD13tumor – WBM, NHD13WBMvsWBM = NHD13WBM – WBM, levels=design)
contrast.matrix <- makeContrasts(NHD13LnegBMvsLnegBM = NHD13LnegBM - LnegBM, NHD13tumorvsLnegBM = NHD13tumor - LnegBM, NHD13tumorvsNHD13LnegBM = NHD13tumor - NHD13LnegBM, NHD13tumorvsNHD13WBM = NHD13tumor - NHD13WBM, NHD13tumorvsSpleen = NHD13tumor - Spleen, NHD13tumorvsWBM = NHD13tumor – WBM, NHD13WBMvsWBM = NHD13WBM – WBM, levels=design)
contrast.matrix <- makeContrasts(NHD13LnegBMvsLnegBM = NHD13LnegBM - LnegBM, NHD13tumorvsLnegBM = NHD13tumor - LnegBM, NHD13tumorvsNHD13LnegBM = NHD13tumor - NHD13LnegBM, NHD13tumorvsNHD13WBM = NHD13tumor - NHD13WBM, NHD13tumorvsSpleen = NHD13tumor - Spleen, NHD13tumorvsWBM = NHD13tumor – WBM, NHD13WBMvsWBM <- NHD13WBM – WBM, levels=design)
contrast.matrix <- makeContrasts(NHD13LnegBM_LnegBM= NHD13LnegBM - LnegBM, NHD13tumor_LnegBM = NHD13tumor - LnegBM, NHD13tumor_NHD13LnegBM = NHD13tumor - NHD13LnegBM, NHD13tumor_NHD13WBM = NHD13tumor - NHD13WBM, NHD13tumor_Spleen = NHD13tumor - Spleen, NHD13tumor_WBM = NHD13tumor – WBM, NHD13WBM_WBM <- NHD13WBM – WBM, levels=design)
?makeContrasts
contrast.matrix <- makeContrasts(NHD13LnegBM_LnegBM= NHD13LnegBM-LnegBM, NHD13tumor_LnegBM = NHD13tumor-LnegBM, NHD13tumor_NHD13LnegBM = NHD13tumor-NHD13LnegBM, NHD13tumor_NHD13WBM = NHD13tumor-NHD13WBM, NHD13tumor_Spleen = NHD13tumor-Spleen, NHD13tumor_WBM = NHD13tumor–WBM, NHD13WBM_WBM = NHD13WBM–WBM, levels=design)
contrast.matrix <- makeContrasts(NHD13LnegBM_LnegBM = NHD13LnegBM-LnegBM, NHD13tumor_LnegBM = NHD13tumor-LnegBM, NHD13tumor_NHD13LnegBM = NHD13tumor-NHD13LnegBM, NHD13tumor_NHD13WBM = NHD13tumor-NHD13WBM, NHD13tumor_Spleen = NHD13tumor-Spleen, NHD13tumor_WBM = NHD13tumor–WBM, NHD13WBM_WBM = NHD13WBM–WBM, levels=design)
contrast.matrix <- makeContrasts(NHD13LnegBM_LnegBM = NHD13LnegBM-LnegBM,NHD13tumor_LnegBM = NHD13tumor-LnegBM,NHD13tumor_NHD13LnegBM = NHD13tumor-NHD13LnegBM,NHD13tumor_NHD13WBM = NHD13tumor-NHD13WBM,NHD13tumor_Spleen = NHD13tumor-Spleen,NHD13tumor_WBM = NHD13tumor–WBM,NHD13WBM_WBM = NHD13WBM–WBM,levels=design)
contrast.matrix <- makeContrasts(NHD13LnegBM-LnegBM,NHD13tumor-LnegBM,NHD13tumor-NHD13LnegBM,NHD13tumor-NHD13WBM,NHD13tumor-Spleen,NHD13tumor–WBM,NHD13WBM–WBM,levels=design)
contrast.matrix <- makeContrasts(NHD13tumorvsNHD13WBM = NHD13tumor - NHD13WBM, NHD13tumorvsWBM = NHD13tumor – WBM, NHD13WBMvsWBM = NHD13WBM – WBM, levels=design)
design
fit <- lmFit(exprs(celfiles.filtered$eset), design)
fit
contrast.matrix <- makeContrasts(NHD13LnegBMvsLnegBM = NHD13LnegBM - LnegBM,NHD13tumorvsLnegBM = NHD13tumor - LnegBM,NHD13tumorvsNHD13LnegBM = NHD13tumor - NHD13LnegBM,NHD13tumorvsNHD13WBM = NHD13tumor - NHD13WBM,NHD13tumorvsSpleen = NHD13tumor - Spleen,NHD13tumorvsWBM = NHD13tumor – WBM,NHD13WBMvsWBM = NHD13WBM – WBM,levels=design)
contrast.matrix <- makeContrasts(NHD13tumor_LnegBM = NHD13tumor - LnegBM, NHD13tumor_NHD13LnegBM = NHD13tumor - NHD13LnegBM, NHD13tumor_NHD13WBM = NHD13tumor - NHD13WBM, NHD13tumor_Spleen = NHD13tumor - Spleen, NHD13tumor_WBM = NHD13tumor - WBM, NHD13LnegBM_LnegBM = NHD13LnegBM - LnegBM, NHD13WBM_WBM <- NHD13WBM - WBM, levels=design)
contrast.matrix
NHD13_fits <- contrasts.fit(fit, contrast.matrix)
NHD13_ebFit <- eBayes(NHD13_fits)
probeset.list.NHD13tumor_LnegBM <- topTable(NHD13_ebFit, coef=1, number=20000, lfc=1)
probeset.list.NHD13tumor_NHD13LnegBM <- topTable(NHD13_ebFit, coef=2, number=20000, lfc=1)
probeset.list.NHD13tumor_NHD13WBM <- topTable(NHD13_ebFit, coef=3, number=20000, lfc=1)
probeset.list.NHD13tumor_Spleen <- topTable(NHD13_ebFit, coef=4, number=20000, lfc=1)
probeset.list.NHD13tumor_WBM <- topTable(NHD13_ebFit, coef=5, number=20000, lfc=1)
probeset.list.NHD13LnegBM_LnegBM <- topTable(NHD13_ebFit, coef=6, number=20000, lfc=1)
probeset.list.NHD13WBM_WBM <- topTable(NHD13_ebFit, coef=7, number=20000, lfc=1)
biocLite("mouse430a2.db")
biocLite("mouse4302.db")
library(mouse4302.db)
library(annotate)
gene.symbols1 <- getSYMBOL(probeset.list.NHD13tumor_LnegBM$ID, "mouse4302")
gene.symbols2 <- getSYMBOL(probeset.list.NHD13tumor_NHD13LnegBM$ID, "mouse4302")
gene.symbols3 <- getSYMBOL(probeset.list.NHD13tumor_NHD13WBM$ID, "mouse4302")
gene.symbols4 <- getSYMBOL(probeset.list.NHD13tumor_Spleen$ID, "mouse4302")
gene.symbols5 <- getSYMBOL(probeset.list.NHD13tumor_WBM$ID, "mouse4302")
gene.symbols6 <- getSYMBOL(probeset.list.NHD13LnegBM_LnegBM$ID, "mouse4302")
gene.symbols7 <- getSYMBOL(probeset.list.NHD13WBM_WBM$ID, "mouse4302")
NHD13tumor_LnegBM_FC2Ann <- cbind(probeset.list.NHD13tumor_LnegBM, gene.symbols1)
NHD13tumor_NHD13LnegBM_FC2Ann <- cbind(probeset.list.NHD13tumor_NHD13LnegBM, gene.symbols2)
NHD13tumor_NHD13WBM_FC2Ann <- cbind(probeset.list.NHD13tumor_NHD13WBM, gene.symbols3)
NHD13tumor_Spleen_FC2Ann <- cbind(probeset.list.NHD13tumor_Spleen, gene.symbols4)
NHD13tumor_WBM_FC2Ann <- cbind(probeset.list.NHD13tumor_WBM, gene.symbols5)
NHD13LnegBM_LnegBM_FC2Ann <- cbind(probeset.list.NHD13LnegBM_LnegBM, gene.symbols6)
NHD13WBM_WBM_FC2Ann <- cbind(probeset.list.NHD13WBM_WBM, gene.symbols7)
write.table(NHD13tumor_LnegBM_FC2Ann , "NHD13tumor_LnegBM_FC2Ann.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_NHD13LnegBM_FC2Ann , "NHD13tumor_NHD13LnegBM_FC2Ann.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_NHD13WBM_FC2Ann , "NHD13tumor_NHD13WBM_FC2Ann.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_Spleen_FC2Ann, "NHD13tumor_Spleen_FC2Ann.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_WBM_FC2Ann , "NHD13tumor_WBM_FC2Ann.txt", sep="\t", quote=FALSE)
write.table(NHD13LnegBM_LnegBM_FC2Ann , "NHD13LnegBM_LnegBM_FC2Ann.txt", sep="\t", quote=FALSE)
write.table(NHD13WBM_WBM_FC2Ann , "NHD13WBM_WBM_FC2Ann.txt", sep="\t", quote=FALSE)
NHD13tumor_LnegBM <- topTable(NHD13_ebFit, coef=1, number=100000, sort.by="logFC")
NHD13tumor_NHD13LnegBM <- topTable(NHD13_ebFit, coef=2, number=100000, sort.by="logFC")
NHD13tumor_NHD13WBM <- topTable(NHD13_ebFit, coef=3, number=100000, sort.by="logFC")
NHD13tumor_Spleen <- topTable(NHD13_ebFit, coef=4, number=100000, sort.by="logFC")
NHD13tumor_WBM <- topTable(NHD13_ebFit, coef=5, number=100000, sort.by="logFC")
NHD13LnegBM_LnegBM <- topTable(NHD13_ebFit, coef=6, number=100000, sort.by="logFC")
NHD13WBM_WBM <- topTable(NHD13_ebFit, coef=7, number=100000, sort.by="logFC")
gene.symbols1 <- getSYMBOL(NHD13tumor_LnegBM$ID, "mouse4302")
gene.symbols2 <- getSYMBOL(NHD13tumor_NHD13LnegBM$ID, "mouse4302")
gene.symbols3 <- getSYMBOL(NHD13tumor_NHD13WBM$ID, "mouse4302")
gene.symbols4 <- getSYMBOL(NHD13tumor_Spleen$ID, "mouse4302")
gene.symbols5 <- getSYMBOL(NHD13tumor_WBM$ID, "mouse4302")
gene.symbols6 <- getSYMBOL(NHD13LnegBM_LnegBM$ID, "mouse4302")
gene.symbols7 <- getSYMBOL(NHD13WBM_WBM$ID, "mouse4302")
NHD13tumor_LnegBM_AllAnn <- cbind(NHD13tumor_LnegBM, gene.symbols1)
NHD13tumor_NHD13LnegBM_AllAnn <- cbind(NHD13tumor_NHD13LnegBM, gene.symbols2)
NHD13tumor_NHD13WBM_AllAnn <- cbind(NHD13tumor_NHD13WBM, gene.symbols3)
NHD13tumor_Spleen_AllAnn <- cbind(NHD13tumor_Spleen, gene.symbols4)
NHD13tumor_WBM_AllAnn <- cbind(NHD13tumor_WBM, gene.symbols5)
NHD13LnegBM_LnegBM_AllAnn <- cbind(NHD13LnegBM_LnegBM, gene.symbols6)
NHD13WBM_WBM_AllAnn <- cbind(NHD13WBM_WBM, gene.symbols7)
write.table(NHD13tumor_LnegBM_AllAnn , "NHD13tumor_LnegBM_AllAnn.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_NHD13LnegBM_AllAnn , "NHD13tumor_NHD13LnegBM_AllAnn.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_NHD13WBM_AllAnn , "NHD13tumor_NHD13WBM_AllAnn.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_Spleen_AllAnn, "NHD13tumor_Spleen_AllAnn.txt", sep="\t", quote=FALSE)
write.table(NHD13tumor_WBM_AllAnn , "NHD13tumor_WBM_AllAnn.txt", sep="\t", quote=FALSE)
write.table(NHD13LnegBM_LnegBM_AllAnn , "NHD13LnegBM_LnegBM_AllAnn.txt", sep="\t", quote=FALSE)
write.table(NHD13WBM_WBM_AllAnn , "NHD13WBM_WBM_AllAnn.txt", sep="\t", quote=FALSE)
NHD13tumor_LnegBM$threshold = as.factor(abs(NHD13tumor_LnegBM$logFC) > 1 & NHD13tumor_LnegBM$P.Value < 0.05)
NHD13tumor_NHD13LnegBM$threshold = as.factor(abs(NHD13tumor_NHD13LnegBM$logFC) > 1 & NHD13tumor_NHD13LnegBM$P.Value < 0.05)
NHD13tumor_NHD13WBM$threshold = as.factor(abs(NHD13tumor_NHD13WBM$logFC) > 1 & NHD13tumor_NHD13WBM$P.Value < 0.05)
NHD13tumor_Spleen$threshold = as.factor(abs(NHD13tumor_Spleen$logFC) > 1 & NHD13tumor_Spleen$P.Value < 0.05)
NHD13tumor_WBM$threshold = as.factor(abs(NHD13tumor_WBM$logFC) > 1 & NHD13tumor_WBM$P.Value < 0.05)
NHD13LnegBM_LnegBM$threshold = as.factor(abs(NHD13LnegBM_LnegBM$logFC) > 1 & NHD13LnegBM_LnegBM$P.Value < 0.05)
NHD13WBM_WBM$threshold = as.factor(abs(NHD13WBM_WBM$logFC) > 1 & NHD13WBM_WBM$P.Value < 0.05)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13tumor_LnegBM$logFC, -log10(NHD13tumor_LnegBM$P.Value), xlim=c(-10, 10), ylim=c(0, 15), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13tumor_LnegBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13tumor_NHD13LnegBM$logFC, -log10(NHD13tumor_NHD13LnegBM$P.Value), xlim=c(-10, 10), ylim=c(0, 15), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13tumor_NHD13LnegBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13tumor_NHD13WBM$logFC, -log10(NHD13tumor_NHD13WBM$P.Value), xlim=c(-10, 10), ylim=c(0, 15), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13tumor_NHD13WBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13tumor_Spleen$logFC, -log10(NHD13tumor_Spleen$P.Value), xlim=c(-10, 10), ylim=c(0, 15), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13tumor_Spleen$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13tumor_WBM$logFC, -log10(NHD13tumor_WBM$P.Value), xlim=c(-10, 10), ylim=c(0, 15), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13tumor_WBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13LnegBM_LnegBM$logFC, -log10(NHD13LnegBM_LnegBM$P.Value), xlim=c(-10, 10), ylim=c(0, 15), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13LnegBM_LnegBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13LnegBM_LnegBM$logFC, -log10(NHD13LnegBM_LnegBM$P.Value), xlim=c(-8, 8), ylim=c(0, 10), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13LnegBM_LnegBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13LnegBM_LnegBM$logFC, -log10(NHD13LnegBM_LnegBM$P.Value), xlim=c(-8, 8), ylim=c(0, 8), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13LnegBM_LnegBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13WBM_WBM$logFC, -log10(NHD13WBM_WBM$P.Value), xlim=c(-10, 10), ylim=c(0, 15), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13WBM_WBM$threshold)
par(mar=c(3,3,2,1), mgp=c(2,.7,0), tck=-.01)
plot(NHD13WBM_WBM$logFC, -log10(NHD13WBM_WBM$P.Value), xlim=c(-8, 8), ylim=c(0, 12), xlab="log2 fold change", ylab="-log10 p-value", pch=19, cex=0.5, col=NHD13WBM_WBM$threshold)
knir::stitch
knitr::stitch
?knitr
?stitch
eset
fix(celfiles.gcrma)
View(eset)
write.table(eset, "GSE40531forGSEA.txt", sep="\t", quote=FALSE)
